% ====================================
% CONFIGURACIÓN DEL DOCUMENTO
% ====================================

% Configuración PDF (DEBE IR PRIMERO)
\pdfminorversion=7
\pdfcompresslevel=9

% Idioma y codificación (inputenc/fontenc obsoletos en LaTeX moderno)
\usepackage[spanish,es-noindentfirst, es-nodecimaldot]{babel}
%\usepackage[T1]{fontenc}
%\usepackage[utf8]{inputenc}

% Geometría de página
%\usepackage[letterpaper,left=3.5cm,right=3cm,top=3cm,bottom=3cm,includehead=false,includefoot=false]{geometry}
\usepackage{geometry}
\geometry{
    letterpaper,
    left=3.5cm,
    right=3.0cm,
    top=3.0cm,
    bottom=3.0cm,
    includehead=false,
    includefoot=false,
    heightrounded,
    % *** CORRECCIÓN PARA EL DESFASE DE 4MM ***
    % Estas opciones fuerzan a geometry a centrar el bloque de texto
    % y anular márgenes predeterminados o "offsets" del driver.
    vcentering, % Centra verticalmente el texto en la página
    hcentering, % Centra horizontalmente el texto en la página
    headheight=0pt % Necesario para compatibilidad de la clase
}

% Fuentes para el documento y matemáticas Times New Roman
\usepackage{newtxtext,newtxmath}
\usepackage[nopatch=all]{microtype}
\usepackage{ifthen}

% Paquetes esenciales
\usepackage{setspace}
\usepackage{graphicx}
\usepackage{float}
\usepackage{parskip}
\usepackage{enumitem}
\usepackage{multirow}
\usepackage{longtable}
\usepackage{array}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{multicol}
\usepackage{calc}

% Formato de documento

% Asegura una numeración simple de página si es deseada, dentro del footer.
\pagestyle{plain}
% Evita espacio extra al final de las páginas.
\raggedbottom
% Sin sangría en los párrafos, si no la deseas.
\setlength{\parindent}{0pt}
% Linestretch global
%\renewcommand*{\baselinestretch}{1.5}

\usepackage[compact]{titlesec}

% ====================================
% BIBLIOGRAFÍA ANTES DE TOCLOFT (FIX "BAILING OUT")
% ====================================
% Bibliografía
\usepackage[nottoc,numbib]{tocbibind}
\usepackage[fixlanguage]{babelbib}
\selectbiblanguage{spanish}
\usepackage[numbers]{natbib}

\usepackage{tocloft}

\providecommand{\tightlist}{}

% Configuración de espaciado de títulos
\titlespacing*{\section}{0pt}{0ex plus 1ex minus .2ex}{-\parskip}
\titlespacing*{\subsection}{0pt}{0ex plus 1ex minus .2ex}{-\parskip}
\titlespacing*{\subsubsection}{0pt}{0ex plus 1ex minus .2ex}{-\parskip}
\titlespacing*{\paragraph}{0pt}{0ex plus 1ex minus .2ex}{0.5ex}
\titlespacing*{\subparagraph}{0pt}{0ex plus 1ex minus .2ex}{0.5ex}
%\setlength{\parindent}{0pt}

% Formato de títulos
\titleformat{\section}[hang]{\normalsize\bfseries}{\thesection}{1ex}{}
\titleformat{\subsection}{\normalsize\bfseries}{\thesubsection}{1ex}{}
\titleformat{\subsubsection}{\normalsize\bfseries}{\thesubsubsection}{1ex}{}

% Configuración de índices
%\cftsetindents{section}{0em}{3em}
%\cftsetindents{subsection}{3em}{3em}
%\cftsetindents{subsubsection}{6em}{4em}
%\cftsetindents{paragraph}{10em}{5em}

% Indents y numwidth (jerarquía visual)
\cftsetindents{section}{0em}{2.3em}
\cftsetindents{subsection}{2.3em}{2.3em}
\cftsetindents{subsubsection}{4.6em}{3.3em}
\cftsetindents{paragraph}{7.9em}{4.6em}
\cftsetindents{subparagraph}{12.5em}{4.8em}

% Espacios post-número (mínimos, como muestras)
%\renewcommand{\cftsecaftersnum}{}% "I.   " (3esp)
%\renewcommand{\cftsubsecaftersnum}{}% "3.1. " (1esp)
%\renewcommand{\cftsubsubsecaftersnum}{}% "4.1.1. " (1esp)

% Numeración y profundidad
\setcounter{secnumdepth}{6}
\setcounter{tocdepth}{4}
\renewcommand{\thesection}{\normalsize{\Roman{section}.}}
\renewcommand{\thesubsection}{\normalsize{\arabic{section}.\arabic{subsection}.}}
\renewcommand{\thesubsubsection}{\normalsize{\arabic{section}.\arabic{subsection}.\arabic{subsubsection}.}}
\renewcommand{\theparagraph}{\normalsize{\arabic{section}.\arabic{subsection}.\arabic{subsubsection}.\arabic{paragraph}}}
\renewcommand{\thesubparagraph}{\normalsize{\arabic{section}.\arabic{subsection}.\arabic{subsubsection}.\arabic{paragraph}.\arabic{subparagraph}}}


% Comandos personalizados
% ====================================
\newcommand{\pdf}[3]{%
  \begin{center}%
    \includegraphics[scale=#1,page=#2]{#3}%
  \end{center}%
}

% ====================================

\newcommand{\pdft}[5]{%
  \begin{center}%
    \ifthenelse{\equal{#5}{true}}{%
      \includegraphics[scale=#1,page=#2,trim=#4,clip]{#3}%
    }{%
      \includegraphics[scale=#1,page=#2]{#3}%
    }%
  \end{center}%
}

% ====================================

\newcommand\xcite[1]{(\citeauthor{#1},~\citeyear{#1})}

% ====================================
\usepackage{ragged2e}  % Para \RaggedRight (si no lo tienes ya)

\newcounter{tocleftparcounter}  % Counter único para labels hyperref

\makeatletter
\newcommand{\tocleftparagraph}[1]{%
  \stepcounter{tocleftparcounter}%  % Incrementa para label único
  \edef\tocleftparlabel{tocleftpar.\thetocleftparcounter}%  % Label como "tocleftpar.1"
  \hypertarget{\tocleftparlabel}{}%  % Ancla invisible en página actual
  \addtocontents{toc}{%
    \protect{%
      \protect\normalsize%  % 12pt APLICADO A TODO: texto, líderes y página
      \protect\l@section{%  % Formato EXACTO de sections: indent 0em (sin padding IZQUIERDO), numwidth 3em (sin padding DERECHO)
        \protect\hyperlink{\tocleftparlabel}{%  % BLOQUE CLICKABLE: texto + líderes + página
          \protect\RaggedRight\protect\textbf{#1}%  % Texto: bold, alineado izquierda
          \protect\cftsecleader%  % Líderes (puntos suspensivos, rellenan perfecto sin padding extra)
        }%
      }{%
        \protect\hyperlink{\tocleftparlabel}{%  % Página: clickable
          \protect\cftsecpagefont\protect\textbf{\thepage}%  % Formato global (bold, 12pt; quita punto si no lo quieres: \thepage)
        }%
      }%
    }%  % Fin del grupo para \normalsize
  }%
}
\makeatother

% ====================================

\newcommand{\leftitemize}[1]{%
  \begin{itemize}[leftmargin=0pt, labelsep=4pt, itemindent=10pt, listparindent=0pt, topsep=0pt, partopsep=0pt, parsep=0pt]%
    \tightlist%
    #1%
  \end{itemize}%
}

% ====================================

\newcommand{\leftenumerate}[1]{%
  \begin{enumerate}[leftmargin=0pt, labelsep=4pt, itemindent=12pt, listparindent=0pt, topsep=0pt, partopsep=0pt, parsep=0pt, label=\arabic{enumi}.]%
    \tightlist%
    #1%
  \end{enumerate}%
}

% ====================================
% HYPERREF - SIEMPRE AL FINAL
% ====================================
\usepackage{hyperref}
\hypersetup{
    %pdftex,
    %pagebackref=true,
    %bookmarks=true,
    pdftitle={Clinica, Animales Menores y Mayores},
    pdfauthor={Luis Eduardo Miranda Barja},
    pdfsubject={Medicina Veterinaria y Zootecnia},
    pdfkeywords={Veterinaria,Zootecnia},
    colorlinks=true,
    linkcolor=black,
    citecolor=darkgray,
    urlcolor=darkgray
}